<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QaliLab AI - Script d'intégration Console</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f5f7;
        }
        .container {
            max-width: 800px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            padding: 20px;
            margin-top: 20px;
        }
        h1, h2 {
            color: #172B4D;
        }
        .step {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background-color: #0052CC;
            color: white;
            text-align: center;
            line-height: 30px;
            border-radius: 50%;
            margin-right: 10px;
        }
        .step h3 {
            display: inline-block;
            vertical-align: middle;
        }
        pre {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            max-height: 300px;
        }
        .alert-info {
            background-color: #DEEBFF;
            border-color: #4C9AFF;
            color: #0747A6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>QaliLab AI - Script d'intégration Console</h1>
        
        <div class="alert alert-info mb-4">
            Ce script peut être copié et exécuté dans la console du navigateur pour ajouter un bouton QaliLab AI à vos pages de tickets JIRA.
        </div>
        
        <div class="step">
            <span class="step-number">1</span>
            <h3>Ouvrir la console du navigateur</h3>
            <p>Naviguez vers une page de ticket JIRA, puis ouvrez la console du navigateur :</p>
            <ul>
                <li>Chrome/Edge : Appuyez sur <kbd>F12</kbd> ou <kbd>Ctrl+Shift+J</kbd> (Windows/Linux) ou <kbd>Cmd+Option+J</kbd> (Mac)</li>
                <li>Firefox : Appuyez sur <kbd>F12</kbd> ou <kbd>Ctrl+Shift+K</kbd> (Windows/Linux) ou <kbd>Cmd+Option+K</kbd> (Mac)</li>
                <li>Safari : Activez d'abord le menu Développeur dans les préférences, puis appuyez sur <kbd>Cmd+Option+C</kbd></li>
            </ul>
        </div>
        
        <div class="step">
            <span class="step-number">2</span>
            <h3>Copier et exécuter le script</h3>
            <p>Copiez le code ci-dessous et collez-le dans la console, puis appuyez sur <kbd>Entrée</kbd> :</p>
            <pre id="scriptContent">{{ script }}</pre>
            <button class="btn btn-primary mt-2" onclick="copyScript()">Copier le script</button>
        </div>
        
        <div class="step">
            <span class="step-number">3</span>
            <h3>Résultat</h3>
            <p>Un bouton "QaliLab AI" devrait apparaître sur la page du ticket. Cliquez dessus pour ouvrir l'outil QaliLab AI dans un nouvel onglet.</p>
            <p>Note : Ce script doit être exécuté à chaque fois que vous ouvrez une nouvelle page de ticket, car il ne persiste pas lors de la navigation.</p>
        </div>
        
        <div class="alert alert-info mb-4">
            <strong>Alternative permanente :</strong> Vous pouvez également utiliser notre <a href="{{ url_for('create_help_script') }}">script d'aide bookmarklet</a> qui peut être installé dans votre barre de favoris pour un accès plus facile.
        </div>
        
        <div class="mt-4 text-center">
            <a href="{{ jira_url }}" class="btn btn-outline-primary">Retourner à JIRA</a>
            <a href="{{ app_url }}" class="btn btn-outline-secondary ms-2">Page d'accueil QaliLab AI</a>
        </div>
    </div>

    <script>
        function copyScript() {
            const scriptContent = document.getElementById('scriptContent').textContent;
            navigator.clipboard.writeText(scriptContent)
                .then(() => {
                    alert('Script copié dans le presse-papier!');
                })
                .catch(err => {
                    console.error('Erreur lors de la copie: ', err);
                    alert('Erreur lors de la copie. Veuillez sélectionner manuellement le texte et le copier.');
                });
        }
    </script>
</body>
</html>